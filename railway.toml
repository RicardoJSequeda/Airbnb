# Railway: backend (api-gateway)
# Despliega desde la raíz del repo para que pnpm resuelva @airbnb-clone/database.
# En Railway: Service → Settings → Root Directory = "." (raíz del repo).

[build]
builder = "nixpacks"
buildCommand = "pnpm install && pnpm --filter @airbnb-clone/database run generate && pnpm run build --filter=api-gateway"

[deploy]
startCommand = "cd apps/api-gateway && node dist/main"
healthcheckPath = "/health"
healthcheckTimeout = 30
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
